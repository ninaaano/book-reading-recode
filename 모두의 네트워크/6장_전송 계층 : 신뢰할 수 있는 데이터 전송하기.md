- 목표
    - 전송 계층의 역할 이해
    - 연결형 통신과 비연결형 통신 이해
    - TCP 이해
    - UDP 이해

## LESSON 23 전송 계층의 역할

다른 네트워크로 데이터를 전송하려면 라우터가 필요함

라우터의 라우팅 기능을 통해 데이터를 전송하더라도 목적지에 도착하지 못할 수도 있다

전송 계층은 목적지에 신뢰할 수 있는 데이터를 전달하기 위해 필요하다

- 오류를 점검하는 기능
- 전송된 데이터의 목적지가 어떤 애플리케이션인지 식별하는 기능

### 연결형 통신과 비연결형 통신

신뢰성/정확성, 효율성으로 구분할 수 있다

연결형 통신 : 신뢰성/정확성은 데이터를 목적지에 문제없이 전달하는 것이고

비연결형 통신 : 효율성은 데이터를 빠르고 효율적으로 전달하는 것이다

연결형 -  TCP

비연결형 - UDP

### 정리

- 전송계층은 데이터를 제대로 전달하는 역할을 하며, 오류를 점검하는 기능도 한다
- 전송 계층은 전송된 데이터의 목적지가 어떤 애플리케이션인지 확인한다
- 연결형 통신은 신뢰할 수 있고 정확하게 데이터를 전송하는 통신 방식이다
- 비연결형 통신은 신회성을 보장하지 않지만 효율적으로 데이터를 전송하는 통신 방식이다


## LESSON 24 TCP의 구조

### TCP?

캡슐화, 역캡슐화

TCP로 전송할 때 붙이는 헤더를 TCP 헤더라고 하고, 이 TCP 헤더가 붙은 데이터를 세그먼트라고 한다. IP헤더와 마찬가지로 순서대로 정보가 나열되어 있다

데이터를 전송하기 전 먼저 연결(connection)이라는 가상의 독점 통신로를 확보해야한다. 이 연결을 확립한 후에 데이터를 전송할 수 있다

> 연결(connection)
TCP 통신에서 정보를 전달하기 위해 사용되는 가상의 통신로로 연결을 확립하고 데이터를 전송한다
> 

코드비트는 TCP 헤더의 107번째 비트부터 112번째 비트까지의 6비트로 연결의 제어 정보가 기록되는 곳이다

코드 비트는 각 비트별로 역할이 있는데, 초깃값은 0이고 비트가 활성화되면 1이 된다. 연결을 확립하려면 이중 SYN, ACK가 필요하다

SYN - 연결 요청

ACK - 확인 응답

### 3-way 핸드셰이크란?

연결은 SYN, ACK을 사용하여 확립할 수 있다. 신뢰할 수 있는 연결을 하려면 데이터를 전송하기 전에 패킷을 교환하는데, 세번 확인한다

패킷 요청을 세 번 교환하는 것을 3-way 핸드셰이크라고 한다

데이터를 전송한 후에는 연결을 끊기 위한 요청을 교환해야하는데

연결을 끊을 때는 FIN, ACK를 사용한다. FIN은 연결 종료

## LESSON 25 일련번호와 확인 응답 번호의 구조
- 일련 번호
    - 송신측에서 수신 측에 이 데이터가 몇 번째 데이터인지 알려주는 역할
    - 전송된 데이터에 일련번호를 부여하면 수신자는 원래 데이터의 몇 번째 데이터를 받았는 지 알 수 있다
- 확인 응답 번호
    - 수신 측이 몇 번째 데이터를 수신했는지 송신 측에 알려주는 역할
    - 예를 들어 10번 데이터를 수신하면 11번 데이터를 송신 측에 요청한다. 이것을 확인 응답이라고 한다

데이터가 항상 올바르게 전달되는 것은 아니므로 일련번호와 확인 응답 번호를 사용해서 데이터가 손상되거나 유실된 경우 데이터를 재전송하게 되어있는데, 이것을 재전송 제어라고 한다

### 윈도우 크기?

세그먼트(데이터) 하나를 보낼 때마다 확인 응답을 한번 반환하는 통신은 효율이 높지 않다

매번 확인 응답을 기다리는 대신 세그먼트를 연속해서 보내고 난 다음에 확인 응답을 반환하면 효율이 높아진다. 받은 세그먼트를 일시적으로 보관하는 장소를 버퍼라고 한다

수신 측은 대량으로 데이터가 전송되면 보관하지 못하고 넘쳐서 오버플로가 발생한다

그러기 위해선 버퍼의 한계 크기를 알고 있어야 하는데 그것이 TCP 헤더의 윈도우 크기 (window size) 값에 해당한다

윈도우 크기는 얼마나 많은 용량의 데이터를 저장해 둘 수 있는지 나타낸다. 즉, 확인 응답을 일일이 하지 않고 연속해서 송수신할 수 있는 데이터 크기다

이 윈도우의 초깃값은 3-way 핸드셰이크를 할 때 판단한다.

상대 버퍼의 한계값을 알면 세그먼트를 오버플로 되지않도록 보내면 된다. 수신 측이 윈도우 크기를 가지고 있다면 확인 응답을 받지 않고도 세그먼트(데이터)를 연속적으로 전송할 수 있다